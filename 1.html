<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>MyTest_twitter</title>
  <link rel="stylesheet" href="f_demon.css">
  <style>
    html,body{
  height: 100%;
  width: 100%;
}

body{
  margin: 0;
  padding: 0;
}

#d1{
  width: 100%;
  height: 100%;
  background: black;
}
</style>
</head>

<body>
  <div id="d1">
  </div>
</body>
<script type="text/javascript">
  function preventBubble(event) {
    var e = arguments.callee.caller.arguments[0] || event
    if (e && e.stopPropagation) {
      e.stopPropagation();
    } else if (window.event) {
      window.event.cancelBubble = true;
    }
  }
  let d = document.getElementById('d1')
  let startX
  let startY
  var d2 
  d.addEventListener('touchstart', function (e) {
    preventBubble()
    console.log(e)
    d2 = document.createElement('div')
    startX = e.targetTouches[0].clientX
    startY = e.targetTouches[0].clientY
    d2.style.background = 'white'
    d2.style.position = 'fixed'
    d2.style.top = startY + 'px'
    d2.style.left = startX + 'px'
    d2.contentEditable = true
    d2.draggable = true
    d.appendChild(d2)
  })
  d.addEventListener('touchmove',function(e){
    let width = e.changedTouches[0].clientX - startX
    let height = e.changedTouches[0].clientY - startY
    d2.style.width = width + 'px'
    d2.style.height = height + 'px'
  })
  d.addEventListener('touchend', function (e) {
    console.log(e)
    preventBubble()
    let offsetX, offsetY, sX, sY, moveX, moveY;
    d2.addEventListener('touchstart', function (e) {
      preventBubble()
      offsetX = e.targetTouches[0].pageX //获取点击点的X坐标    
      offsetY = e.targetTouches[0].pageY
      sX = e.target.offsetLeft
      sY = e.target.offsetTop
      console.log(offsetX, offsetY, sX, sY)

    })
    d2.addEventListener('touchend', function (e) {
      preventBubble()
    })
    d2.addEventListener('touchmove', function (e) {
      preventBubble()
      moveX = e.targetTouches[0].pageX; //移动过程中X轴的坐标
      moveY = e.targetTouches[0].pageY; //移动过程中Y轴的坐标
      d2.style.left=moveX+sX-offsetX+'px'
      d2.style.top=moveY+sY-offsetY+'px'
    })
  })
</script>

</html>